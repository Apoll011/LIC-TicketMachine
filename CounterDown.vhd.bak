library IEEE;
use IEEE.std_logic_1164.all;

entity CounterDown is

port(
	A : in std_logic_vector(3 downto 0);
	PL : in std_logic;
	CE : in std_logic;
	CLK : in std_logic;
	Q : out std_logic_vector(3 downto 0);
	RESET : in std_logic
	);

end entity;

Architecture logicFuntion of CounterDown is

component MUX4
port (
	A, B: in std_logic_vector(3 downto 0);
	OP: in std_logic;
	F: out std_logic_vector(3 downto 0)
);
end component;

component AdderSubtrator
Port (A : in STD_LOGIC_VECTOR (3 downto 0); 
		B : iN STD_LOGIC_VECTOR (3 downto 0);
      CBi, OPau : in std_logic;
		iCBO : out std_logic;
      R : out STD_LOGIC_VECTOR (3 downto 0)
);
end component;

component Reg
PORT( CLK : in std_logic;
RESET : in STD_LOGIC;
D : IN STD_LOGIC_VECTOR(3 downto 0);
EN : IN STD_LOGIC;
Q : out std_logic_VECTOR(3 downto 0)
);
end component;

signal mux_out : std_logic_vector(3 downto 0);
signal reg_out : std_logic_vector(3 downto 0);
signal som_out : std_logic_vector(3 downto 0);

begin

mux : MUX4 port map (A => som_out, B => A, OP => PL, F => mux_out);
registo : Reg port map (CLK => CLK, RESET => RESET, D => mux_out, EN => CE, Q => reg_out);
som : AdderSubtrator port map (A => reg_out, B => "0000", R => som_out, CBi => '1', OPau => '1');

Q <= reg_out;

end logicFuntion;